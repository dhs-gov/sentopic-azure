from csv import reader
import nltk
from globals import globalvars, globalutils


class CsvRow:
    def __init__(self, row_num, text):
        self.row_num = row_num
        self.text = text

def get_data(csv_file):
    with open(csv_file, 'r', encoding='cp850', errors='ignore') as read_obj:
        csv_reader = reader(read_obj)
        csv_rows = []
        for row in csv_reader:
            text = "".join(row)
            text = text.replace("\n", "")

            # Make sure text is not over max tokens
            if len(nltk.word_tokenize(text)) > globalvars.MAX_TOKENS:
                text = globalutils.get_last_sentence(text)

            csv_rows.append(text)

        return csv_rows